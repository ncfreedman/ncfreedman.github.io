<!DOCTYPE html>
<html>
<title>Noah Chaim Freedman</title>
<script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="headshot.jpg">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Raleway", sans-serif}

.sidebar {
  margin: 0;
  padding: 0;
  width: 300px;
  background-color: #f1f1f1;
  position: fixed;
  height: 100%;
  overflow: auto;
}

@media screen and (max-width: 1000px) {
  .sidebar {
    width: 100%;
    height: auto;
    position: relative;
  }
  div.content {margin-left: 0;}
}

@media screen and (max-width: 400px) {
  .sidebar a {
    text-align: center;
    float: none;
  }
}

</style>
<body class="w3-white w3-content" style="max-width:1600px">

<!-- Sidebar/menu -->
<div class="sidebar">
    <br>
    <div class="w3-container w3-center" style="height:0;width:100%;padding-bottom:80%;">
        <img src="headshot.jpg" style="width:80%;" class="w3-round"><br><br>
    </div>
    <div class="w3-container w3-center">
        <font size="5%"><b>Noah Chaim Freedman</b></font>
    </div>
    <div class="w3-panel w3-large w3-center">
        <b><a href="freedman.pdf" download><img src="cv_icon.jpg" class="rounded" style="height:30px"/></a></b>&nbsp&nbsp
        <b><a href = "https://scholar.google.com/citations?user=EXLKL30AAAAJ&hl=en&oi=ao" target="_blank"><img src="scholar_icon.jpg" class="rounded" style="height:30px"/></a></b>&nbsp&nbsp
        <b><a href = "https://github.com/ncfreedman" target="_blank"><img src="github_icon.jpg" class="rounded" style="height:30px"/></a></b>&nbsp&nbsp
        <b><a href = "mailto: noah.freedman@pitt.edu"><img src="mail_icon.jpg" class="rounded" style="height:30px"/></a></b>&nbsp&nbsp
        <b><a href = "https://twitter.com/ncfreedman" target="_blank"><img src="twitter_icon.jpg" class="rounded" style="height:30px"/></a></b>&nbsp&nbsp
    </div>

    <div class="w3-bar-block">
        <font size="+2">
            <a href="index.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>bio</a>

            <a href="science.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>science</a>

            <!--<a href="links.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>links</a>-->

            <a href="notes.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>notes</a>

            <a href="music.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>music</a>

            <a href="koans.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>koans</a>

            <!--<a href="quotes.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-angle-double-right fa-fw w3-margin-right"></i>quotes</a>-->
        </font>
    </div>
<!--</nav>-->
</div>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px">
    <br>
    <header id="Expectation Maximization">
        <div class="w3-container">
            <h1><b><font size="+7">Expectation Maximization</font></b></h1>
        </div>
    </header>
    <div class="w3-container w3-padding-large" style="margin-bottom:32px">
        <font size="+2">
EM algorithms are extremely useful schemes in unsupervised learning. Let's say we have a set of observations \(\{x_i\}_{i=1}^N\) and we want to fit a model with latent variables \(\textbf{z}\) and parameters \(\theta\). Our log-likelihood function takes the form<br><br>

\[
log(p(\textbf x|\theta))=\sum_{i=1}^{N}log(p(x_i|\theta))=\sum_{i=1}^{N}log\Big(\sum_{\textbf{z}}p(x_i, \textbf{z}|\theta)\Big)
\]<br>

Now, we can introduce an arbitrary set of distributions \(\{Q_i(\textbf{z})\}_{i=1}^{N}\) and use Jensen's inequality to obtain a loose lower bound on the log-likelihood as follows<br><br>

\[
\sum_{i=1}^{N}log\Big(\sum_{\textbf{z}}Q_i(\textbf{z})\frac{p(x_i, \textbf{z}|\theta)}{Q_i(\textbf{z})}\Big)\geq\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log\Big(\frac{p(x_i, \textbf{z}|\theta)}{Q_i(\textbf{z})}\Big)
\]<br>

For a fixed \(\theta\) we can make this bound tight by setting \(Q_i(\textbf{z})\propto p(x_i,\textbf{z}|\theta)\) as<br><br>

\[
Q_i(\textbf{z})=\frac{p(x_i,\textbf{z}|\theta)}{\sum_{\widetilde{\textbf{z}}}p(x_i,\widetilde{\textbf{z}}|\theta)}=\frac{p(x_i,\textbf{z}|\theta)}{p(x_i|\theta)}=p(\textbf{z}|x_i,\theta)
\]<br>

We can now obtain new estimates of our parameters by fixing \(\textbf{Q}\) and optimizing this lower bound w.r.t. \(\theta\). Given our updated \(\theta\), we proceed by constructing a new lower bound with which we can once again update our \(\theta\) in the same manner. Note that since the \(Q\) are indepent of \(\theta\) during the optimization step, we can recast optimizing the lower bound as<br><br>

\[
\arg\max_{\theta}\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log\Big(\frac{p(x_i, \textbf{z}|\theta)}{Q_i(\textbf{z})}\Big)=\arg\max_{\theta}\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log(p(x_i, \textbf{z}|\theta))
\]<br>

This procedure is iterated as such until we obtain convergence in \(\theta\) or in the log-likelihood. This algorithm monotonically increases in the log-likelihood but will only guarantee a local maximum.<br><br>

<h1><b><font size="+3">Alternative Lower Bound Derivation</font></b></h1><br>

We define a function \(\mathcal{L}(Q,\theta)\) and show how it is related to \(log(p(x,\theta))\).<br><br>

\begin{equation*}
\begin{aligned}
\mathcal{L}(\textbf{Q},\theta){} &=\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log\Big(\frac{p(\textbf{z}|x_i,\theta)p(x_i|\theta)}{Q_i(\textbf{z})}\Big)\\
&=\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log\Big(\frac{p(\textbf{z}|x_i,\theta)}{Q_i(\textbf{z})}\Big)+\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log(p(x_i|\theta))\\
&=\sum_{i=1}^{N}\sum_{\textbf{z}}Q_i(\textbf{z})log\Big(\frac{p(\textbf{z}|x_i,\theta)}{Q_i(\textbf{z})}\Big)+\sum_{i=1}^{N}log(p(x_i|\theta))\\
&=-\sum_{i=1}^{N}KL(Q_i(\textbf{z})||p(\textbf{z}|x_i,\theta)) + log(p(\textbf{x}|\theta))
\end{aligned}
\end{equation*}<br>

Now we can rearrange to get another angle on the lower bound we used above.<br><br>

\begin{equation*}
\begin{aligned}
log(p(\textbf{x}|\theta))=\mathcal{L}(Q(\textbf{z}),\theta)+\sum_{i=1}^{N}KL(Q_i(\textbf{z})||p(\textbf{z}|x_i,\theta))
\end{aligned}
\end{equation*}<br>

This form also has a nice interpretation for the starting point of Jensen's inequality, where the inequality sign is obtained by removing the \(KL\) term which is always \(\geq0\). This also further explains our choice of \(\textbf{Q}\) at each iteration to make tight the lower bound, as that choice minimizes the \(KL\) terms.
        </font>
    </div>    
</div>
    

<script>
// Script to open and close sidebar
function w3_open() {
    document.getElementById("mySidebar").style.display = "block";
    document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
    document.getElementById("mySidebar").style.display = "none";
    document.getElementById("myOverlay").style.display = "none";
}
</script>

</body>
</html>
